var E=Object.defineProperty;var A=(e,a,n)=>a in e?E(e,a,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[a]=n;var b=(e,a,n)=>A(e,typeof a!="symbol"?a+"":a,n);import{j as s}from"./Accordion-B0xeqd_u.js";import{c as D}from"./ReactAppend-Da6mr3zD.js";import{G as M,C as G}from"./CreateReactScript-D3qb0hcY.js";import{A as H}from"./Adminto-CM-4Vh3D.js";import{r as i}from"./index-B80Lgev0.js";import{B as S}from"./BusinessIWorkCard-BsMRBA8t.js";import{M as z}from"./Modal-C44m6j55.js";import"./index-STwnHZb6.js";import"./index.esm-X2U-7gJn.js";import"./___vite-browser-external_commonjs-proxy-C9-083JZ.js";import"./main-DtAlmsP1.js";import"./Logout-C-aUOij0.js";import"./tippy-react.esm-PO7soYrD.js";import"./TippyButton-DN-nzi_f.js";import"./WhatsAppModal-BYoU6ug0.js";import"./SurveyStep-C1GxQ1hd.js";import"./index-BK7CmI7H.js";const w=(e,a="en-US")=>(Number(e)||0).toLocaleString(a,{maximumFractionDigits:2,minimumFractionDigits:2});class B extends S{constructor(){super(...arguments);b(this,"path","root/services")}}const I=({id:e,name:a,description:n,correlative:o,status:l,onStatusClicked:m,onPlanesClicked:d})=>s.jsx("div",{className:`card mb-0 border shadow-sm ${l?"":"opacity-50"}`,style:{width:"240px",minHeight:"120px",transition:"all 0.3s ease"},children:s.jsxs("div",{className:"card-body",children:[s.jsxs("div",{className:"d-flex align-items-center mb-2",children:[s.jsx("img",{src:`//${o}.${M.APP_DOMAIN}/assets/img/icon.svg`,onError:r=>{r.target.onerror=null,r.target.src="/assets/img/icon.svg"},alt:a,className:"me-2",style:{width:"24px",height:"24px",objectFit:"contain",objectPosition:"center"}}),s.jsx("h4",{className:"mt-0 mb-0 text-truncate",children:a})]}),s.jsx("small",{className:"d-block text-muted mb-2",children:n||"Sin descripci칩n"}),s.jsxs("div",{className:"d-flex justify-content-between align-items-center gap-1",children:[s.jsxs("button",{className:`btn btn-xs ${l?"btn-success":"btn-danger"}`,onClick:()=>m(e,!!l),children:[s.jsx("i",{className:`mdi ${l?"mdi-toggle-switch":"mdi-toggle-switch-off"} me-1`}),l?"Activo":"Inactivo"]}),s.jsxs("button",{className:"btn btn-xs btn-secondary",onClick:d,children:[s.jsx("i",{className:"mdi mdi-cards me-1"}),"Planes"]})]})]})},`service-${e}`);class O extends S{constructor(){super(...arguments);b(this,"path","root/plans")}}const C=({editedPlan:e,handleInputChange:a,handleCancelEdit:n,handleSaveEdit:o})=>s.jsx("div",{className:"card mb-0 shadow-sm hover-shadow-lg transition-all",style:{width:"280px",borderRadius:"12px"},children:s.jsxs("div",{className:"card-body p-3",children:[s.jsxs("div",{className:"text-start",children:[s.jsxs("div",{className:"form-group mb-2",children:[s.jsx("label",{htmlFor:"plan-name",className:"form-label mb-1",children:"Plan"}),s.jsx("input",{id:"plan-name",type:"text",className:"form-control form-control-sm",value:(e==null?void 0:e.name)||"",onChange:l=>a("name",l.target.value)})]}),s.jsxs("div",{className:"form-group mb-2",children:[s.jsx("label",{htmlFor:"plan-description",className:"form-label mb-1",children:"Descripci칩n"}),s.jsx("textarea",{id:"plan-description",className:"form-control form-control-sm",value:(e==null?void 0:e.description)||"",onChange:l=>a("description",l.target.value),style:{minHeight:2*27,fieldSizing:"content"}})]})]}),s.jsx("div",{className:"pricing-section",children:s.jsxs("div",{className:"row",children:[s.jsx("div",{className:"col-6",children:s.jsxs("div",{className:"form-group",children:[s.jsx("label",{htmlFor:"plan-monthly-price",className:"form-label mb-1",children:"Precio x mes"}),s.jsx("div",{className:"input-group",children:s.jsx("input",{id:"plan-monthly-price",type:"number",className:"form-control form-control-sm",value:(e==null?void 0:e.monthly_price)||0,onChange:l=>a("monthly_price",parseFloat(l.target.value)||0)})})]})}),s.jsx("div",{className:"col-6",children:s.jsxs("div",{className:"form-group",children:[s.jsx("label",{htmlFor:"plan-annual-price",className:"form-label mb-1",children:"Precio x a침o"}),s.jsx("div",{className:"input-group",children:s.jsx("input",{id:"plan-annual-price",type:"number",className:"form-control form-control-sm",value:(e==null?void 0:e.annual_price)||0,onChange:l=>a("annual_price",parseFloat(l.target.value)||0)})})]})})]})}),s.jsxs("div",{className:"d-flex justify-content-center gap-2 mt-2",children:[s.jsx("button",{className:"btn btn-sm btn-secondary",onClick:n,type:"button",children:"Cancelar"}),s.jsx("button",{className:"btn btn-sm btn-primary",onClick:o,type:"button",children:"Guardar"})]})]})}),U=new B,q=new O,J=({services:e})=>{var g;i.useRef();const a=i.useRef(),[n,o]=i.useState(e),[l,m]=i.useState(null),[d,r]=i.useState(null),[h,x]=i.useState(null),[j,p]=i.useState(!1),k=async(t,c)=>{const u=await U.status({id:t,status:c});o(n.map(y=>y.id===t?u:y))},R=t=>{m(t),r(null),p(!1),$(a.current).modal("show")},F=t=>{p(!1),r(t),x({...t})},f=()=>{r(null),x(null),p(!1)},_=()=>{p(!0),r(null),x({name:"",description:"",monthly_price:0,annual_price:0})},N=async()=>{try{const t=await q.save({...h,service_id:l.id});m(j?{...l,plans:[...l.plans,t]}:{...l,plans:l.plans.map(c=>c.id===h.id?t:c)}),r(null),x(null),p(!1)}catch(t){console.error("Error saving plan:",t)}},v=(t,c)=>{x(u=>({...u,[t]:c}))};return s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"d-flex flex-wrap gap-3 justify-content-center",children:n.map(t=>s.jsx(I,{...t,onPlanesClicked:()=>R(t),onStatusClicked:k},t.id))}),s.jsx(z,{modalRef:a,title:`Planes - ${l==null?void 0:l.name}`,size:"full-width",bodyStyle:{backgroundColor:"#ebeff2"},hideFooter:!0,children:s.jsxs("div",{className:"d-flex h-100 gap-3 overflow-x-auto pb-2 position-relative align-items-center justify-content-center",style:{minHeight:"calc(100vh - 150px)"},children:[(g=l==null?void 0:l.plans)==null?void 0:g.map(t=>(d==null?void 0:d.id)===t.id?s.jsx(C,{editedPlan:h,handleInputChange:v,handleCancelEdit:f,handleSaveEdit:N},t.id):s.jsx("div",{className:"card mb-0 shadow-sm hover-shadow-lg transition-all",style:{width:"280px",borderRadius:"12px"},children:s.jsxs("div",{className:"card-body p-3",children:[s.jsx("div",{className:"d-flex float-end mb-2",children:s.jsx("button",{className:"btn btn-link text-primary p-0",onClick:()=>F(t),type:"button",children:s.jsx("i",{className:"mdi mdi-pencil"})})}),s.jsxs("div",{className:"text-start",children:[s.jsx("h3",{className:"card-title fw-bold text-primary mb-2",children:t.name}),s.jsx("p",{className:"card-text text-muted mb-0",children:t.description})]}),s.jsx("div",{className:"pricing-section",children:s.jsxs("div",{className:"text-center mt-3",children:[s.jsxs("div",{className:"d-flex justify-content-center align-items-baseline mb-2",children:[s.jsx("span",{className:"fs-5 me-2",children:"S/"}),s.jsx("h1",{className:"display-5 fw-bold mb-0",children:w(t.monthly_price)}),s.jsx("span",{className:"text-muted ms-2",children:"/mes"})]}),s.jsx("div",{className:"text-muted",children:s.jsxs("span",{className:"badge bg-light text-dark fs-8",children:["o S/ ",w(t.annual_price)," / a침o"]})})]})})]})},t.id)),j?s.jsx(C,{editedPlan:h,handleInputChange:v,handleCancelEdit:f,handleSaveEdit:N}):s.jsx("div",{className:"d-flex justify-content-center",style:{width:"120px"},children:s.jsx("button",{className:"btn btn-primary rounded-circle",style:{width:"50px",height:"50px"},onClick:_,type:"button",children:s.jsx("i",{className:"mdi mdi-plus"})})})]})})]})};G((e,a)=>{if(!a.can("services","root"))return location.href="/";D(e).render(s.jsx(H,{...a,title:"Servicios",children:s.jsx(J,{...a})}))});
