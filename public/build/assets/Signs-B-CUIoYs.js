var y=Object.defineProperty;var h=(n,a,r)=>a in n?y(n,a,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[a]=r;var o=(n,a,r)=>h(n,typeof a!="symbol"?a+"":a,r);import{C as N,c as w,R as e,r as m}from"./CreateReactScript-Bw6dYrhr.js";import{A as v}from"./Adminto-CX-uvMqT.js";import{S as u}from"./sweetalert2.esm.all-B0Dix5B2.js";import{B as S}from"./BasicRest-B6zr4KsD.js";class B extends S{constructor(){super(...arguments);o(this,"path","signs");o(this,"hasFiles",!0)}}const d=new B,R=({businesses:n=[]})=>{const[a,r]=m.useState(!1),[g,f]=m.useState([]),p=g.reduce((t,s)=>(t[s.business_id]=s,t),{}),E=async t=>{const s=t.target.files[0];if(!s)return;if(t.target.value=null,!s.type.startsWith("image/")){u.fire({title:"Error",text:"El archivo debe ser una imagen",icon:"error",confirmButtonText:"Aceptar"});return}const i=t.target.getAttribute("data-id"),l=new FormData;l.append("sign",s),l.append("business_id",i),r(!0);const x=await d.save(l);r(!1),x&&c()},b=async t=>{const{isConfirmed:s}=await u.fire({title:"¿Estás seguro?",text:"Esta acción no se puede deshacer",icon:"warning",showCancelButton:!0,confirmButtonText:"Sí, eliminar",cancelButtonText:"No, cancelar"});if(!s)return;r(!0);const i=await d.delete(t);r(!1),i&&c()},c=async()=>{const t=await d.paginate({isLoadingAll:!0});t&&f(t.data)};return m.useEffect(()=>{c()},[null]),e.createElement(e.Fragment,null,e.createElement("div",{className:"d-flex align-items-center justify-content-center",style:{minHeight:"calc(100vh - 135px)"}},e.createElement("div",{className:"d-flex flex-wrap justify-content-center gap-3",style:{maxWidth:"960px"}},n.map((t,s)=>{const i=p[t.id],l=`file-${t.uuid}`;return e.createElement("div",{key:`business-${s}`,className:"card mb-0",style:{width:"280px"}},e.createElement("input",{id:l,type:"file",className:"form-control",accept:"image/*",hidden:!0,"data-id":t.uuid,onChange:E,disabled:a}),e.createElement("div",{className:"card-body position-relative p-0"},i?e.createElement(e.Fragment,null,e.createElement("label",{htmlFor:l},e.createElement("img",{src:`/repository/signs/${i.sign}`,alt:`${t.name} signature`,className:"w-100",style:{aspectRatio:5/2,objectFit:"contain",cursor:a?"not-allowed":"pointer"}})),e.createElement("button",{className:"btn btn-soft-danger btn-xs position-absolute waves-effect rounded-pill",style:{top:"0.5rem",right:"0.5rem"},type:"button",onClick:()=>b(i.id)},e.createElement("i",{className:"mdi mdi-trash-can"}))):e.createElement("label",{htmlFor:l,className:"d-flex align-items-center justify-content-center",style:{aspectRatio:5/2,cursor:a?"not-allowed":"pointer"}},e.createElement("div",{className:"text-center text-muted"},e.createElement("i",{className:"fa fa-signature fa-2x mb-2 d-block"}),e.createElement("p",{className:"mb-0"},"Agregar firma")))),e.createElement("div",{className:"card-footer bg-light"},e.createElement("h6",{className:"text-center my-0 text-truncate"},e.createElement("i",{className:"fa fa-building me-1"}),e.createElement("b",null,t.name))))}))))};N((n,a)=>{w(n).render(e.createElement(v,{...a,title:"Firmas digitales"},e.createElement(R,{...a})))});
