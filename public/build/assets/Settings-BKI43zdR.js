var v=Object.defineProperty;var j=(o,e,s)=>e in o?v(o,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):o[e]=s;var p=(o,e,s)=>j(o,typeof e!="symbol"?e+"":e,s);import{m as c,r as a,j as i,C as w,c as E}from"./CreateReactScript-iip1gB5Y.js";import{T as R,R as h}from"./Table-Ft69a6jc.js";import{A as N}from"./Adminto-CSif9jKy.js";import{M as T}from"./Modal-BraO4vUP.js";import{I as b}from"./InputFormGroup-kYucUB7g.js";import{T as C}from"./TippyButton-Cordycn3.js";import"./Logout-C5ryHcd-.js";import"./tippy-CLq_8JA_.js";import"./sweetalert2.esm.all-B0Dix5B2.js";const F=(o,e)=>{o.root.innerHTML=e};class d{}p(d,"paginate",async e=>{const{result:s}=await c.Fetch("/api/settings/paginate",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(e)});return s}),p(d,"save",async e=>{try{const{status:s,result:r}=await c.Fetch("/api/settings",{method:"POST",body:JSON.stringify(e)});if(!s)throw new Error((r==null?void 0:r.message)||"Ocurrio un error inesperado");return c.Notify.add({icon:"/assets/img/icon.svg",title:"Correcto",body:r.message,type:"success"}),!0}catch(s){return c.Notify.add({icon:"/assets/img/icon.svg",title:"Error",body:s.message,type:"danger"}),!1}}),p(d,"status",async({id:e,status:s})=>{try{const{status:r,result:n}=await c.Fetch("/api/settings/status",{method:"PATCH",body:JSON.stringify({id:e,status:s})});if(!r)throw new Error((n==null?void 0:n.message)??"Ocurrio un error inesperado");return c.Notify.add({icon:"/assets/img/icon.svg",title:"Correcto",body:n.message,type:"success"}),!0}catch(r){return c.Notify.add({icon:"/assets/img/icon.svg",title:"Error",body:r.message,type:"danger"}),!1}}),p(d,"delete",async e=>{try{const{status:s,result:r}=await c.Fetch(`/api/settings/${e}`,{method:"DELETE"});if(!s)throw new Error((r==null?void 0:r.message)??"Ocurrio un error inesperado");return c.Notify.add({icon:"/assets/img/icon.svg",title:"Correcto",body:r.message,type:"success"}),!0}catch(s){return c.Notify.add({icon:"/assets/img/icon.svg",title:"Error",body:s.message,type:"danger"}),!1}});const S=({col:o,label:e,eRef:s,value:r,required:n=!1,rows:f=3,theme:m="snow"})=>{const g=a.useRef();return a.useEffect(()=>{const l=new Quill(g.current,{theme:m,modules:{toolbar:[["bold","italic","underline","strike"],["blockquote","code-block"],[{list:"ordered"},{list:"bullet"}]]}});l.on("text-change",()=>{s.current.value=l.root.innerHTML}),s.editor=l},[null]),i.jsxs("div",{className:`form-group ${o} mb-2`,style:{height:"max-content"},children:[i.jsxs("label",{htmlFor:"",children:[e," ",n&&i.jsx("b",{className:"text-danger",children:"*"})]}),i.jsx("div",{ref:g,style:{height:"100px"},children:r}),i.jsx("input",{ref:s,type:"hidden",required:n,rows:f})]})},O=({can:o})=>{const e=a.useRef(),s=a.useRef(),r=a.useRef(),n=a.useRef(),f=a.useRef(),m=a.useRef(),[g,l]=a.useState(!1),y=t=>{t!=null&&t.id?l(!0):l(!1),r.current.value=(t==null?void 0:t.id)||null,n.current.value=(t==null?void 0:t.name)||null,F(f.editor,(t==null?void 0:t.value)||null),m.current.value=(t==null?void 0:t.description)||null,$(s.current).modal("show")},x=async t=>{t.preventDefault();const u={id:r.current.value||void 0,name:n.current.value,value:f.current.value,description:m.current.value};await d.save(u)&&($(e.current).dxDataGrid("instance").refresh(),$(s.current).modal("hide"))};return i.jsxs(i.Fragment,{children:[i.jsx(R,{gridRef:e,title:"Configuracion",rest:d,toolBar:t=>{t.unshift({widget:"dxButton",location:"after",options:{icon:"refresh",hint:"Refrescar tabla",onClick:()=>$(e.current).dxDataGrid("instance").refresh()}}),t.unshift({widget:"dxButton",location:"after",options:{icon:"plus",hint:"Nuevo registro",onClick:()=>y()}})},columns:[{dataField:"id",caption:"ID",dataType:"number",sortOrder:"asc"},{dataField:"name",caption:"Estado de tabla"},{dataField:"description",caption:"Descripcion",cellTemplate:(t,{value:u})=>{u?h(t,u):h(t,i.jsx("i",{className:"text-muted",children:"- Sin descripcion -"}))}},{caption:"Acciones",cellTemplate:(t,{data:u})=>{o("settings","root","all","update")&&h(t,i.jsx(C,{className:"btn btn-xs btn-soft-primary",title:"Editar",onClick:()=>y(u),children:i.jsx("i",{className:"fa fa-pen"})}))},allowFiltering:!1,allowExporting:!1}]}),i.jsx(T,{modalRef:s,title:g?"Editar configuracion":"Agregar configuracion",onSubmit:x,size:"md",children:i.jsxs("div",{className:"row",id:"settings-crud-container",children:[i.jsx("input",{ref:r,type:"hidden"}),i.jsx(b,{eRef:n,label:"Alias",col:"col-12",required:!0}),i.jsx(b,{eRef:m,label:"Descripcion",col:"col-12"}),i.jsx(S,{eRef:f,label:"Valor",col:"col-12",theme:"bubble",required:!0})]})})]})};w((o,e)=>{if(!e.can("settings","root","all","list"))return location.href="/";E(o).render(i.jsx(N,{...e,title:"Constantes de configuracion",children:i.jsx(O,{...e})}))});
