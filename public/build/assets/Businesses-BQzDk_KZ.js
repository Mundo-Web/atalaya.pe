var C=Object.defineProperty;var B=(n,i,e)=>i in n?C(n,i,{enumerable:!0,configurable:!0,writable:!0,value:e}):n[i]=e;var N=(n,i,e)=>B(n,typeof i!="symbol"?i+"":i,e);import{j as t}from"./Accordion-B0xeqd_u.js";import{c as y}from"./ReactAppend-Da6mr3zD.js";import{G as b,C as E}from"./CreateReactScript-RU15QjVK.js";import{A as S}from"./Adminto-Bd8o-Rrc.js";import{r as g}from"./index-B80Lgev0.js";import{S as x}from"./SurveyStep-C1GxQ1hd.js";import{B as R}from"./BusinessIWorkCard-CmzstVqU.js";import{i as j}from"./tippy-react.esm-PO7soYrD.js";import{U as k}from"./UsersByServicesByBusinessesRest-CeSKXHYN.js";import"./RootBusinessCard-CZOfxu3V.js";import{S as A}from"./ServicesByBusinessesRest-BhOrhVR5.js";import"./index-STwnHZb6.js";import"./index.esm-B9FXdcpn.js";import"./___vite-browser-external_commonjs-proxy-C9-083JZ.js";import"./main-DtAlmsP1.js";import"./Logout-C-aUOij0.js";import"./TippyButton-DN-nzi_f.js";import"./WhatsAppModal-BYoU6ug0.js";import"./index-BK7CmI7H.js";class D extends R{constructor(){super(...arguments);N(this,"path","root/businesses")}}const T=new k,P=new A,_=({onStatusClicked:n,onDeleteClicked:i,...e})=>{var m,w;const[r,h]=g.useState(e.users),[a,c]=g.useState(e.services),d=async s=>{const{isConfirmed:o}=await x.fire({title:"¿Estás seguro?",text:"No podrás revertir esta acción",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Sí, eliminar",cancelButtonText:"Cancelar"});!o||!await T.delete(s)||h(f=>f.filter(p=>p.match_id!==s))},l=async s=>{const{isConfirmed:o}=await x.fire({title:"¿Estás seguro?",text:"No podrás revertir esta acción",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Sí, eliminar",cancelButtonText:"Cancelar"});!o||!await P.delete(s)||c(f=>f.filter(p=>p.match_id!==s))};return t.jsx("div",{className:"card mb-0",style:{width:"420px"},children:t.jsxs("div",{className:"card-body",children:[t.jsxs("div",{className:"dropdown float-end",children:[t.jsx("a",{href:"#",className:"dropdown-toggle arrow-none card-drop","data-bs-toggle":"dropdown","aria-expanded":"false",children:t.jsx("i",{className:"mdi mdi-dots-vertical"})}),t.jsxs("div",{className:"dropdown-menu dropdown-menu-end ",children:[e.status?t.jsxs("button",{className:"dropdown-item",onClick:()=>n(e.id,!0),children:[t.jsx("i",{className:"mdi mdi-cancel me-1"}),t.jsx("span",{children:"Deshabilitar"})]}):t.jsxs("button",{className:"dropdown-item",onClick:()=>n(e.id,!1),children:[t.jsx("i",{className:"mdi mdi-restore me-1"}),t.jsx("span",{children:"Habilitar"})]}),t.jsx(j,{content:"Eliminar definitivamente",children:t.jsxs("button",{className:"dropdown-item",onClick:()=>i(e.id),children:[t.jsx("i",{className:"mdi mdi-delete me-1"}),t.jsx("span",{children:"Eliminar"})]})})]})]}),t.jsxs("h4",{className:"header-title mt-0 mb-1 text-truncate",children:[!e.status&&t.jsx("small",{className:"me-1 text-danger fw-bold",children:"(Deshabilitada)"}),e.name]}),t.jsxs("div",{className:"mb-2",children:[t.jsx("span",{className:"d-block",children:(m=e.creator)==null?void 0:m.fullname}),t.jsx("small",{className:"text-muted",children:(w=e.creator)==null?void 0:w.email})]}),(a==null?void 0:a.length)>0&&t.jsx("div",{className:"d-flex gap-2",children:a==null?void 0:a.map(s=>t.jsx(j,{content:`Eliminar ${s.name} de ${e.name}`,children:t.jsxs("div",{className:"hover-container",children:[t.jsx("img",{className:"avatar-xs",src:`//${s.correlative}.${b.APP_DOMAIN}/assets/img/icon.svg`,onError:o=>o.target.src="/assets/img/icon.svg",alt:s.name,style:{objectFit:"contain",objectPosition:"center"}}),t.jsx("button",{className:"hover:show btn btn-light btn-xs rounded-pill",onClick:()=>l(s.match_id),children:t.jsx("i",{className:"mdi mdi-close"})})]},s.id)}))}),t.jsxs("div",{className:"d-flex align-items-center gap-2",children:[t.jsx("hr",{className:"flex-grow-1 my-2"}),t.jsxs("span",{children:[(r==null?void 0:r.length)||0," usuarios"]})]}),t.jsx("div",{className:"table-responsive",style:{height:"241px"},children:t.jsx("table",{className:"table table-sm mb-0",children:t.jsx("tbody",{children:r==null?void 0:r.map((s,o)=>t.jsxs("tr",{children:[t.jsx("td",{valign:"middle",style:{width:"0%",borderBottomWidth:o===r.length-1?0:void 0},children:t.jsxs("div",{className:"position-relative",style:{width:"max-content",height:"max-content"},children:[t.jsx("img",{src:`/api/profile/thumbnail/${s.relative_id}`,alt:"",className:"avatar-sm rounded-circle"}),t.jsx(j,{content:s.service.name,children:t.jsx("img",{className:"position-absolute bg-white rounded border",src:`//${s.service.correlative}.${b.APP_DOMAIN}/assets/img/icon.svg`,onError:u=>u.target.src="/assets/img/icon.svg",alt:s.service.name,style:{objectFit:"contain",objectPosition:"center",width:"20px",height:"20px",padding:"2px",bottom:"-6px",right:"-6px"}})})]})}),t.jsxs("td",{style:{width:"100%",borderBottomWidth:o===r.length-1?0:void 0},children:[t.jsx("span",{className:"d-block",children:s.fullname}),t.jsx("small",{className:"text-muted",children:s.email})]}),t.jsx("td",{valign:"middle",style:{borderBottomWidth:o===r.length-1?0:void 0},children:s.id!=e.creator.id&&t.jsx("button",{className:"btn btn-xs btn-soft-danger",onClick:()=>d(s.match_id),children:t.jsx("i",{className:"fa fa-trash-alt"})})})]},o))})})})]})},e.id)},v=new D,U=({businesses:n})=>{const[i,e]=g.useState(n),r=async(a,c)=>{const d=await v.status({id:a,status:c});e(i.map(l=>l.id===a?d:l))},h=async a=>{!(await x.fire({title:"¿Estás seguro?",text:"¡Esta acción no se puede deshacer!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"¡Sí, continuar!"})).isConfirmed||!(await x.fire({title:"¿Estás REALMENTE seguro?",text:"¡Esta es tu última oportunidad, la acción no se podrá revertir!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"¡Sí, eliminar definitivamente!"})).isConfirmed||!await v.delete(a)||e(i.filter(m=>m.id!==a))};return t.jsx(t.Fragment,{children:t.jsx("div",{className:"d-flex flex-wrap gap-3 justify-content-center",children:i.map(a=>t.jsx(_,{...a,onStatusClicked:r,onDeleteClicked:h}))})})};E((n,i)=>{if(!i.can("businesses","root"))return location.href="/";y(n).render(t.jsx(S,{...i,title:"Empresas",children:t.jsx(U,{...i})}))});
