var b=Object.defineProperty;var N=(i,t,r)=>t in i?b(i,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):i[t]=r;var p=(i,t,r)=>N(i,typeof t!="symbol"?t+"":t,r);import{j as e}from"./Accordion-B0xeqd_u.js";import{c as v}from"./ReactAppend-Da6mr3zD.js";import{G as C,C as B}from"./CreateReactScript-wxngZ06p.js";import{A as y}from"./Adminto-Bej9pNZR.js";import{r as j}from"./index-B80Lgev0.js";import{S as x}from"./SurveyStep-C1GxQ1hd.js";import{B as E}from"./BusinessIWorkCard-CQ8PkW75.js";import{i as f}from"./tippy-react.esm-PO7soYrD.js";import{U as R}from"./UsersByServicesByBusinessesRest-CHc1jz-A.js";import"./index-STwnHZb6.js";import"./index.esm-X2U-7gJn.js";import"./___vite-browser-external_commonjs-proxy-C9-083JZ.js";import"./main-DtAlmsP1.js";import"./Logout-C-aUOij0.js";import"./TippyButton-DN-nzi_f.js";import"./WhatsAppModal-BYoU6ug0.js";class S extends E{constructor(){super(...arguments);p(this,"path","root/businesses")}}const k=new R,A=({users:i,onStatusClicked:t,onDeleteClicked:r,...a})=>{var d,l;const[n,o]=j.useState(i),m=async s=>{const{isConfirmed:c}=await x.fire({title:"¿Estás seguro?",text:"No podrás revertir esta acción",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Sí, eliminar",cancelButtonText:"Cancelar"});!c||!await k.delete(s)||o(g=>g.filter(w=>w.match_id!==s))};return e.jsx("div",{className:"card mb-0",style:{width:"420px"},children:e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"dropdown float-end",children:[e.jsx("a",{href:"#",className:"dropdown-toggle arrow-none card-drop","data-bs-toggle":"dropdown","aria-expanded":"false",children:e.jsx("i",{className:"mdi mdi-dots-vertical"})}),e.jsxs("div",{className:"dropdown-menu dropdown-menu-end ",children:[a.status?e.jsxs("button",{className:"dropdown-item",onClick:()=>t(a.id,!0),children:[e.jsx("i",{className:"mdi mdi-cancel me-1"}),e.jsx("span",{children:"Deshabilitar"})]}):e.jsxs("button",{className:"dropdown-item",onClick:()=>t(a.id,!1),children:[e.jsx("i",{className:"mdi mdi-restore me-1"}),e.jsx("span",{children:"Habilitar"})]}),e.jsx(f,{content:"Eliminar definitivamente",children:e.jsxs("button",{className:"dropdown-item",onClick:()=>r(a.id),children:[e.jsx("i",{className:"mdi mdi-delete me-1"}),e.jsx("span",{children:"Eliminar"})]})})]})]}),e.jsxs("h4",{className:"header-title mt-0 mb-1 text-truncate",children:[!a.status&&e.jsx("small",{className:"me-1 text-danger fw-bold",children:"(Deshabilitada)"}),a.name]}),e.jsxs("div",{children:[e.jsx("span",{className:"d-block",children:(d=a.creator)==null?void 0:d.fullname}),e.jsx("small",{className:"text-muted",children:(l=a.creator)==null?void 0:l.email})]}),e.jsxs("div",{className:"d-flex align-items-center gap-2",children:[e.jsx("hr",{className:"flex-grow-1 my-2"}),e.jsxs("span",{children:[(n==null?void 0:n.length)||0," usuarios"]})]}),e.jsx("div",{className:"table-responsive",style:{height:"241px"},children:e.jsx("table",{className:"table table-sm mb-0",children:e.jsx("tbody",{children:n==null?void 0:n.map((s,c)=>e.jsxs("tr",{children:[e.jsx("td",{valign:"middle",style:{width:"0%",borderBottomWidth:c===n.length-1?0:void 0},children:e.jsxs("div",{className:"position-relative",style:{width:"max-content",height:"max-content"},children:[e.jsx("img",{src:`/api/profile/thumbnail/${s.relative_id}`,alt:"",className:"avatar-sm rounded-circle"}),e.jsx(f,{content:s.service.name,children:e.jsx("img",{className:"position-absolute bg-white rounded border",src:`//${s.service.correlative}.${C.APP_DOMAIN}/assets/img/icon.svg`,onError:h=>h.target.src="/assets/img/icon.svg",alt:s.service.name,style:{objectFit:"contain",objectPosition:"center",width:"20px",height:"20px",padding:"2px",bottom:"-6px",right:"-6px"}})})]})}),e.jsxs("td",{style:{width:"100%",borderBottomWidth:c===n.length-1?0:void 0},children:[e.jsx("span",{className:"d-block",children:s.fullname}),e.jsx("small",{className:"text-muted",children:s.email})]}),e.jsx("td",{valign:"middle",style:{borderBottomWidth:c===n.length-1?0:void 0},children:s.id!=a.creator.id&&e.jsx("button",{className:"btn btn-xs btn-soft-danger",onClick:()=>m(s.match_id),children:e.jsx("i",{className:"fa fa-trash-alt"})})})]},c))})})})]})},a.id)},u=new S,D=({businesses:i})=>{const[t,r]=j.useState(i),a=async(o,m)=>{const d=await u.status({id:o,status:m});r(t.map(l=>l.id===o?d:l))},n=async o=>{!(await x.fire({title:"¿Estás seguro?",text:"¡Esta acción no se puede deshacer!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"¡Sí, continuar!"})).isConfirmed||!(await x.fire({title:"¿Estás REALMENTE seguro?",text:"¡Esta es tu última oportunidad, la acción no se podrá revertir!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"¡Sí, eliminar definitivamente!"})).isConfirmed||!await u.delete(o)||r(t.filter(s=>s.id!==o))};return e.jsx(e.Fragment,{children:e.jsx("div",{className:"d-flex flex-wrap gap-3 justify-content-center",children:t.map(o=>e.jsx(A,{...o,onStatusClicked:a,onDeleteClicked:n}))})})};B((i,t)=>{if(!t.can("businesses","root"))return location.href="/";v(i).render(e.jsx(y,{...t,title:"Empresas",children:e.jsx(D,{...t})}))});
