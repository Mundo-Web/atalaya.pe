var w=Object.defineProperty;var N=(i,a,n)=>a in i?w(i,a,{enumerable:!0,configurable:!0,writable:!0,value:n}):i[a]=n;var d=(i,a,n)=>N(i,typeof a!="symbol"?a+"":a,n);import{C as v,c as S,j as e,r as u}from"./CreateReactScript-CjXADJBG.js";import{A as B,i as F}from"./Adminto-DVlShn4E.js";import{S as f}from"./sweetalert2.esm.all-B0Dix5B2.js";import{B as C}from"./BasicRest-CvPeBcQU.js";class E extends C{constructor(){super(...arguments);d(this,"path","signs");d(this,"hasFiles",!0)}}const m=new E,R=({businesses:i=[]})=>{const[a,n]=u.useState(!1),[p,h]=u.useState([]),x=p.reduce((t,s)=>(t[s.business_id]||(t[s.business_id]=[]),t[s.business_id].push(s),t),{}),g=async t=>{const s=t.target.files[0];if(!s)return;if(t.target.value=null,!s.type.startsWith("image/")){f.fire({title:"Error",text:"El archivo debe ser una imagen",icon:"error",confirmButtonText:"Aceptar"});return}const l=t.target.getAttribute("data-id"),r=t.target.getAttribute("data-sign"),c=new FormData;r&&c.append("id",r),c.append("sign",s),c.append("business_id",l),n(!0);const b=await m.save(c);n(!1),b&&o()},j=async t=>{const{isConfirmed:s}=await f.fire({title:"¿Estás seguro?",text:"Esta acción no se puede deshacer",icon:"warning",showCancelButton:!0,confirmButtonText:"Sí, eliminar",cancelButtonText:"No, cancelar"});if(!s)return;n(!0);const l=await m.delete(t);n(!1),l&&o()},o=async()=>{const t=await m.paginate({isLoadingAll:!0,sort:[{selector:"created_at",desc:!1}]});t&&h(t.data)};u.useEffect(()=>{o()},[null]);const y=(t,s,l)=>{var c;const r=`file-${t.uuid}-${l}`;return e.jsxs("div",{className:"position-relative",style:{width:"25%",aspectRatio:".5"},children:[s?e.jsxs(e.Fragment,{children:[e.jsx("label",{htmlFor:r,className:"w-100 h-100",children:e.jsx("img",{src:`/repository/signs/${s.sign}`,alt:`${t.name} signature ${l+1}`,className:"w-100 h-100",style:{objectFit:"cover",objectPosition:"center",cursor:a?"not-allowed":"pointer"}})}),e.jsx(F,{content:"Quitar firma",children:e.jsx("i",{className:"mdi mdi-trash-can mdi-24px position-absolute text-danger",style:{top:"0.25rem",right:"0.25rem"},type:"button",onClick:()=>j(s.id)})})]}):e.jsx("label",{htmlFor:r,className:"d-flex align-items-center justify-content-center w-100 h-100",style:{cursor:a?"not-allowed":"pointer"},children:e.jsx("div",{className:"text-center text-muted",children:e.jsx("i",{className:"fa fa-plus fa-lg"})})}),e.jsx("input",{id:r,type:"file",className:"form-control",accept:"image/*",hidden:!0,"data-id":t.uuid,"data-sign":s==null?void 0:s.id,onChange:g,disabled:a||((c=x[t.id])==null?void 0:c.length)>=4&&!s})]})};return e.jsx(e.Fragment,{children:e.jsx("div",{className:"d-flex align-items-center justify-content-center",style:{minHeight:"calc(100vh - 135px)"},children:e.jsx("div",{className:"d-flex flex-wrap justify-content-center gap-3",style:{maxWidth:"960px"},children:i.map((t,s)=>{const l=x[t.id]||[];return e.jsxs("div",{className:"card mb-0",style:{width:"280px"},children:[e.jsx("div",{className:"card-body position-relative p-0",children:e.jsx("div",{className:"d-flex flex-wrap",children:[0,1,2,3].map(r=>y(t,l[r],r))})}),e.jsx("div",{className:"card-footer bg-light",children:e.jsxs("h6",{className:"text-center my-0 text-truncate",children:[e.jsx("i",{className:"fa fa-building me-1"}),e.jsx("b",{children:t.name})]})})]},`business-${s}`)})})})})};v((i,a)=>{S(i).render(e.jsx(B,{...a,title:"Firmas digitales",children:e.jsx(R,{...a})}))});
