var v=Object.defineProperty;var w=(o,e,r)=>e in o?v(o,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):o[e]=r;var p=(o,e,r)=>w(o,typeof e!="symbol"?e+"":e,r);import{m as c,r as a,R as n,C as R,c as N}from"./CreateReactScript-BEd-rCvk.js";import{T,R as y}from"./Table-CkOiOv3b.js";import{A as x}from"./Adminto-DLuiK9jn.js";import{M as C}from"./Modal-BOzbh0wA.js";import{I as E}from"./InputFormGroup-BeEaa9zP.js";import{T as F}from"./TippyButton-BY_H9Q4Q.js";import"./sweetalert2.esm.all-B0Dix5B2.js";const S=(o,e)=>{o.root.innerHTML=e};class m{}p(m,"paginate",async e=>{const{result:r}=await c.Fetch("/api/settings/paginate",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(e)});return r}),p(m,"save",async e=>{try{const{status:r,result:s}=await c.Fetch("/api/settings",{method:"POST",body:JSON.stringify(e)});if(!r)throw new Error((s==null?void 0:s.message)||"Ocurrio un error inesperado");return c.Notify.add({icon:"/assets/img/icon.svg",title:"Correcto",body:s.message,type:"success"}),!0}catch(r){return c.Notify.add({icon:"/assets/img/icon.svg",title:"Error",body:r.message,type:"danger"}),!1}}),p(m,"status",async({id:e,status:r})=>{try{const{status:s,result:i}=await c.Fetch("/api/settings/status",{method:"PATCH",body:JSON.stringify({id:e,status:r})});if(!s)throw new Error((i==null?void 0:i.message)??"Ocurrio un error inesperado");return c.Notify.add({icon:"/assets/img/icon.svg",title:"Correcto",body:i.message,type:"success"}),!0}catch(s){return c.Notify.add({icon:"/assets/img/icon.svg",title:"Error",body:s.message,type:"danger"}),!1}}),p(m,"delete",async e=>{try{const{status:r,result:s}=await c.Fetch(`/api/settings/${e}`,{method:"DELETE"});if(!r)throw new Error((s==null?void 0:s.message)??"Ocurrio un error inesperado");return c.Notify.add({icon:"/assets/img/icon.svg",title:"Correcto",body:s.message,type:"success"}),!0}catch(r){return c.Notify.add({icon:"/assets/img/icon.svg",title:"Error",body:r.message,type:"danger"}),!1}});const O=({col:o,label:e,eRef:r,value:s,required:i=!1,rows:d=3,theme:f="snow"})=>{const g=a.useRef();return a.useEffect(()=>{const l=new Quill(g.current,{theme:f,modules:{toolbar:[["bold","italic","underline","strike"],["blockquote","code-block"],[{list:"ordered"},{list:"bullet"}]]}});l.on("text-change",()=>{r.current.value=l.root.innerHTML}),r.editor=l},[null]),n.createElement("div",{className:`form-group ${o} mb-2`,style:{height:"max-content"}},n.createElement("label",{htmlFor:""},e," ",i&&n.createElement("b",{className:"text-danger"},"*")),n.createElement("div",{ref:g,style:{height:"100px"}},s),n.createElement("input",{ref:r,type:"hidden",required:i,rows:d}))},A=({can:o})=>{const e=a.useRef(),r=a.useRef(),s=a.useRef(),i=a.useRef(),d=a.useRef(),f=a.useRef(),[g,l]=a.useState(!1),h=t=>{t!=null&&t.id?l(!0):l(!1),s.current.value=(t==null?void 0:t.id)||null,i.current.value=(t==null?void 0:t.name)||null,S(d.editor,(t==null?void 0:t.value)||null),f.current.value=(t==null?void 0:t.description)||null,$(r.current).modal("show")},b=async t=>{t.preventDefault();const u={id:s.current.value||void 0,name:i.current.value,value:d.current.value,description:f.current.value};await m.save(u)&&($(e.current).dxDataGrid("instance").refresh(),$(r.current).modal("hide"))};return n.createElement(n.Fragment,null,n.createElement(T,{gridRef:e,title:"Configuracion",rest:m,toolBar:t=>{t.unshift({widget:"dxButton",location:"after",options:{icon:"refresh",hint:"Refrescar tabla",onClick:()=>$(e.current).dxDataGrid("instance").refresh()}}),t.unshift({widget:"dxButton",location:"after",options:{icon:"plus",hint:"Nuevo registro",onClick:()=>h()}})},columns:[{dataField:"id",caption:"ID",dataType:"number",sortOrder:"asc"},{dataField:"name",caption:"Estado de tabla"},{dataField:"description",caption:"Descripcion",cellTemplate:(t,{value:u})=>{u?y(t,u):y(t,n.createElement("i",{className:"text-muted"},"- Sin descripcion -"))}},{caption:"Acciones",cellTemplate:(t,{data:u})=>{o("settings","root","all","update")&&y(t,n.createElement(F,{className:"btn btn-xs btn-soft-primary",title:"Editar",onClick:()=>h(u)},n.createElement("i",{className:"fa fa-pen"})))},allowFiltering:!1,allowExporting:!1}]}),n.createElement(C,{modalRef:r,title:g?"Editar configuracion":"Agregar configuracion",onSubmit:b,size:"md"},n.createElement("div",{className:"row",id:"settings-crud-container"},n.createElement("input",{ref:s,type:"hidden"}),n.createElement(E,{eRef:i,label:"Alias",col:"col-12",required:!0}),n.createElement(E,{eRef:f,label:"Descripcion",col:"col-12"}),n.createElement(O,{eRef:d,label:"Valor",col:"col-12",theme:"bubble",required:!0}))))};R((o,e)=>{if(!e.can("settings","root","all","list"))return location.href="/";N(o).render(n.createElement(x,{...e,title:"Constantes de configuracion"},n.createElement(A,{...e})))});
