var b=Object.defineProperty;var w=(i,t,n)=>t in i?b(i,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):i[t]=n;var h=(i,t,n)=>w(i,typeof t!="symbol"?t+"":t,n);import{j as e}from"./Accordion-B0xeqd_u.js";import{c as N}from"./ReactAppend-Da6mr3zD.js";import{G as v,C}from"./CreateReactScript-wxngZ06p.js";import{A as B}from"./Adminto-Bej9pNZR.js";import{r as u}from"./index-B80Lgev0.js";import{S as p}from"./SurveyStep-C1GxQ1hd.js";import{B as y}from"./BusinessIWorkCard-CQ8PkW75.js";import{i as f}from"./tippy-react.esm-PO7soYrD.js";import{U as E}from"./UsersByServicesByBusinessesRest-CHc1jz-A.js";import"./index-STwnHZb6.js";import"./index.esm-X2U-7gJn.js";import"./___vite-browser-external_commonjs-proxy-C9-083JZ.js";import"./main-DtAlmsP1.js";import"./Logout-C-aUOij0.js";import"./TippyButton-DN-nzi_f.js";import"./WhatsAppModal-BYoU6ug0.js";class R extends y{constructor(){super(...arguments);h(this,"path","root/businesses")}}const k=new E,S=({users:i,onStatusClicked:t,onDeleteClicked:n,...a})=>{var c,l;const[r,o]=u.useState(i),m=async s=>{await k.delete(s)&&o(x=>x.filter(g=>g.match_id!==s))};return e.jsx("div",{className:"card mb-0",style:{width:"420px"},children:e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"dropdown float-end",children:[e.jsx("a",{href:"#",className:"dropdown-toggle arrow-none card-drop","data-bs-toggle":"dropdown","aria-expanded":"false",children:e.jsx("i",{className:"mdi mdi-dots-vertical"})}),e.jsxs("div",{className:"dropdown-menu dropdown-menu-end ",children:[a.status?e.jsxs("button",{className:"dropdown-item",onClick:()=>t(a.id,!0),children:[e.jsx("i",{className:"mdi mdi-cancel me-1"}),e.jsx("span",{children:"Deshabilitar"})]}):e.jsxs("button",{className:"dropdown-item",onClick:()=>t(a.id,!1),children:[e.jsx("i",{className:"mdi mdi-restore me-1"}),e.jsx("span",{children:"Habilitar"})]}),e.jsx(f,{content:"Eliminar definitivamente",children:e.jsxs("button",{className:"dropdown-item",onClick:()=>n(a.id),children:[e.jsx("i",{className:"mdi mdi-delete me-1"}),e.jsx("span",{children:"Eliminar"})]})})]})]}),e.jsxs("h4",{className:"header-title mt-0 mb-1 text-truncate",children:[!a.status&&e.jsx("small",{className:"me-1 text-danger fw-bold",children:"(Deshabilitada)"}),a.name]}),e.jsxs("div",{children:[e.jsx("span",{className:"d-block",children:(c=a.creator)==null?void 0:c.fullname}),e.jsx("small",{className:"text-muted",children:(l=a.creator)==null?void 0:l.email})]}),e.jsxs("div",{className:"d-flex align-items-center gap-2",children:[e.jsx("hr",{className:"flex-grow-1 my-2"}),e.jsxs("span",{children:[(r==null?void 0:r.length)||0," usuarios"]})]}),e.jsx("div",{className:"table-responsive",style:{height:"241px"},children:e.jsx("table",{className:"table table-sm mb-0",children:e.jsx("tbody",{children:r==null?void 0:r.map((s,d)=>e.jsxs("tr",{children:[e.jsx("td",{valign:"middle",style:{width:"0%",borderBottomWidth:d===r.length-1?0:void 0},children:e.jsxs("div",{className:"position-relative",style:{width:"max-content",height:"max-content"},children:[e.jsx("img",{src:`/api/profile/thumbnail/${s.relative_id}`,alt:"",className:"avatar-sm rounded-circle"}),e.jsx(f,{content:s.service.name,children:e.jsx("img",{className:"position-absolute bg-white rounded border",src:`//${s.service.correlative}.${v.APP_DOMAIN}/assets/img/icon.svg`,onError:x=>x.target.src="/assets/img/icon.svg",alt:s.service.name,style:{objectFit:"contain",objectPosition:"center",width:"20px",height:"20px",padding:"2px",bottom:"-6px",right:"-6px"}})})]})}),e.jsxs("td",{style:{width:"100%",borderBottomWidth:d===r.length-1?0:void 0},children:[e.jsx("span",{className:"d-block",children:s.fullname}),e.jsx("small",{className:"text-muted",children:s.email})]}),e.jsx("td",{valign:"middle",style:{borderBottomWidth:d===r.length-1?0:void 0},children:s.id!=a.creator.id&&e.jsx("button",{className:"btn btn-xs btn-soft-danger",onClick:()=>m(s.match_id),children:e.jsx("i",{className:"fa fa-trash-alt"})})})]},d))})})})]})},a.id)},j=new R,A=({businesses:i})=>{const[t,n]=u.useState(i),a=async(o,m)=>{const c=await j.status({id:o,status:m});n(t.map(l=>l.id===o?c:l))},r=async o=>{!(await p.fire({title:"¿Estás seguro?",text:"¡Esta acción no se puede deshacer!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"¡Sí, continuar!"})).isConfirmed||!(await p.fire({title:"¿Estás REALMENTE seguro?",text:"¡Esta es tu última oportunidad, la acción no se podrá revertir!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"¡Sí, eliminar definitivamente!"})).isConfirmed||!await j.delete(o)||n(t.filter(s=>s.id!==o))};return e.jsx(e.Fragment,{children:e.jsx("div",{className:"d-flex flex-wrap gap-3 justify-content-center",children:t.map(o=>e.jsx(S,{...o,onStatusClicked:a,onDeleteClicked:r}))})})};C((i,t)=>{if(!t.can("businesses","root"))return location.href="/";N(i).render(e.jsx(B,{...t,title:"Empresas",children:e.jsx(A,{...t})}))});
