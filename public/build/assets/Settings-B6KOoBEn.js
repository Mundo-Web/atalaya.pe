var v=Object.defineProperty;var j=(o,e,r)=>e in o?v(o,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):o[e]=r;var p=(o,e,r)=>j(o,typeof e!="symbol"?e+"":e,r);import{j as i}from"./Accordion-B0xeqd_u.js";import{r as a}from"./index-B80Lgev0.js";import{c as w}from"./ReactAppend-Da6mr3zD.js";import{C as E}from"./CreateReactScript-wxngZ06p.js";import{T as R,R as h}from"./Table-BKtRPVyk.js";import{m as c}from"./main-DtAlmsP1.js";import{A as N}from"./Adminto-D364ytFN.js";import{M as T}from"./Modal-DydUDwtE.js";import{I as b}from"./InputFormGroup-Bup-dfDc.js";import{T as C}from"./TippyButton-Bqhz5Wik.js";import"./index-STwnHZb6.js";import"./index.esm-X2U-7gJn.js";import"./___vite-browser-external_commonjs-proxy-C9-083JZ.js";import"./Logout-C-aUOij0.js";import"./tippy-react.esm-PO7soYrD.js";import"./TippyButton-DN-nzi_f.js";import"./WhatsAppModal-BYoU6ug0.js";import"./SurveyStep-C1GxQ1hd.js";const F=(o,e)=>{o.root.innerHTML=e};class d{}p(d,"paginate",async e=>{const{result:r}=await c.Fetch("/api/settings/paginate",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(e)});return r}),p(d,"save",async e=>{try{const{status:r,result:s}=await c.Fetch("/api/settings",{method:"POST",body:JSON.stringify(e)});if(!r)throw new Error((s==null?void 0:s.message)||"Ocurrio un error inesperado");return c.Notify.add({icon:"/assets/img/icon.svg",title:"Correcto",body:s.message,type:"success"}),!0}catch(r){return c.Notify.add({icon:"/assets/img/icon.svg",title:"Error",body:r.message,type:"danger"}),!1}}),p(d,"status",async({id:e,status:r})=>{try{const{status:s,result:n}=await c.Fetch("/api/settings/status",{method:"PATCH",body:JSON.stringify({id:e,status:r})});if(!s)throw new Error((n==null?void 0:n.message)??"Ocurrio un error inesperado");return c.Notify.add({icon:"/assets/img/icon.svg",title:"Correcto",body:n.message,type:"success"}),!0}catch(s){return c.Notify.add({icon:"/assets/img/icon.svg",title:"Error",body:s.message,type:"danger"}),!1}}),p(d,"delete",async e=>{try{const{status:r,result:s}=await c.Fetch(`/api/settings/${e}`,{method:"DELETE"});if(!r)throw new Error((s==null?void 0:s.message)??"Ocurrio un error inesperado");return c.Notify.add({icon:"/assets/img/icon.svg",title:"Correcto",body:s.message,type:"success"}),!0}catch(r){return c.Notify.add({icon:"/assets/img/icon.svg",title:"Error",body:r.message,type:"danger"}),!1}});const S=({col:o,label:e,eRef:r,value:s,required:n=!1,rows:m=3,theme:f="snow"})=>{const g=a.useRef();return a.useEffect(()=>{const l=new Quill(g.current,{theme:f,modules:{toolbar:[["bold","italic","underline","strike"],["blockquote","code-block"],[{list:"ordered"},{list:"bullet"}]]}});l.on("text-change",()=>{r.current.value=l.root.innerHTML}),r.editor=l},[null]),i.jsxs("div",{className:`form-group ${o} mb-2`,style:{height:"max-content"},children:[i.jsxs("label",{htmlFor:"",children:[e," ",n&&i.jsx("b",{className:"text-danger",children:"*"})]}),i.jsx("div",{ref:g,style:{height:"100px"},children:s}),i.jsx("input",{ref:r,type:"hidden",required:n,rows:m})]})},O=({can:o})=>{const e=a.useRef(),r=a.useRef(),s=a.useRef(),n=a.useRef(),m=a.useRef(),f=a.useRef(),[g,l]=a.useState(!1),y=t=>{t!=null&&t.id?l(!0):l(!1),s.current.value=(t==null?void 0:t.id)||null,n.current.value=(t==null?void 0:t.name)||null,F(m.editor,(t==null?void 0:t.value)||null),f.current.value=(t==null?void 0:t.description)||null,$(r.current).modal("show")},x=async t=>{t.preventDefault();const u={id:s.current.value||void 0,name:n.current.value,value:m.current.value,description:f.current.value};await d.save(u)&&($(e.current).dxDataGrid("instance").refresh(),$(r.current).modal("hide"))};return i.jsxs(i.Fragment,{children:[i.jsx(R,{gridRef:e,title:"Configuracion",rest:d,toolBar:t=>{t.unshift({widget:"dxButton",location:"after",options:{icon:"refresh",hint:"Refrescar tabla",onClick:()=>$(e.current).dxDataGrid("instance").refresh()}}),t.unshift({widget:"dxButton",location:"after",options:{icon:"plus",hint:"Nuevo registro",onClick:()=>y()}})},columns:[{dataField:"id",caption:"ID",dataType:"number",sortOrder:"asc"},{dataField:"name",caption:"Estado de tabla"},{dataField:"description",caption:"Descripcion",cellTemplate:(t,{value:u})=>{u?h(t,u):h(t,i.jsx("i",{className:"text-muted",children:"- Sin descripcion -"}))}},{caption:"Acciones",cellTemplate:(t,{data:u})=>{o("settings","root","all","update")&&h(t,i.jsx(C,{className:"btn btn-xs btn-soft-primary",title:"Editar",onClick:()=>y(u),children:i.jsx("i",{className:"fa fa-pen"})}))},allowFiltering:!1,allowExporting:!1}]}),i.jsx(T,{modalRef:r,title:g?"Editar configuracion":"Agregar configuracion",onSubmit:x,size:"md",children:i.jsxs("div",{className:"row",id:"settings-crud-container",children:[i.jsx("input",{ref:s,type:"hidden"}),i.jsx(b,{eRef:n,label:"Alias",col:"col-12",required:!0}),i.jsx(b,{eRef:f,label:"Descripcion",col:"col-12"}),i.jsx(S,{eRef:m,label:"Valor",col:"col-12",theme:"bubble",required:!0})]})})]})};E((o,e)=>{if(!e.can("settings","root","all","list"))return location.href="/";w(o).render(i.jsx(N,{...e,title:"Constantes de configuracion",children:i.jsx(O,{...e})}))});
