import{j as t}from"./Accordion-B0xeqd_u.js";import{c as v}from"./ReactAppend-Da6mr3zD.js";import{G as N,C}from"./CreateReactScript-RU15QjVK.js";import{A as B}from"./Adminto-CShpcwxy.js";import{r as g}from"./index-B80Lgev0.js";import{S as x}from"./SurveyStep-C1GxQ1hd.js";import{B as y}from"./BusinessesRest-CvkkDKnD.js";import{i as j}from"./tippy-react.esm-PO7soYrD.js";import{U as E}from"./UsersByServicesByBusinessesRest-BuMJH5bE.js";import"./RootBusinessCard-BoxzY95L.js";import{S}from"./ServicesByBusinessesRest-C4vVMHm8.js";import"./index-STwnHZb6.js";import"./index.esm-B9FXdcpn.js";import"./___vite-browser-external_commonjs-proxy-C9-083JZ.js";import"./main-DtAlmsP1.js";import"./Logout-C-aUOij0.js";import"./TippyButton-DN-nzi_f.js";import"./WhatsAppModal-BYoU6ug0.js";import"./BusinessIWorkCard-BsMRBA8t.js";import"./index-BK7CmI7H.js";const R=new E,k=new S,A=({onStatusClicked:o,onDeleteClicked:r,...s})=>{var m,w;const[a,h]=g.useState(s.users),[i,c]=g.useState(s.services),d=async e=>{const{isConfirmed:n}=await x.fire({title:"¿Estás seguro?",text:"No podrás revertir esta acción",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Sí, eliminar",cancelButtonText:"Cancelar"});!n||!await R.delete(e)||h(f=>f.filter(p=>p.match_id!==e))},l=async e=>{const{isConfirmed:n}=await x.fire({title:"¿Estás seguro?",text:"No podrás revertir esta acción",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Sí, eliminar",cancelButtonText:"Cancelar"});!n||!await k.delete(e)||c(f=>f.filter(p=>p.match_id!==e))};return t.jsx("div",{className:"card mb-0",style:{width:"420px"},children:t.jsxs("div",{className:"card-body",children:[t.jsxs("div",{className:"dropdown float-end",children:[t.jsx("a",{href:"#",className:"dropdown-toggle arrow-none card-drop","data-bs-toggle":"dropdown","aria-expanded":"false",children:t.jsx("i",{className:"mdi mdi-dots-vertical"})}),t.jsxs("div",{className:"dropdown-menu dropdown-menu-end ",children:[s.status?t.jsxs("button",{className:"dropdown-item",onClick:()=>o(s.id,!0),children:[t.jsx("i",{className:"mdi mdi-cancel me-1"}),t.jsx("span",{children:"Deshabilitar"})]}):t.jsxs("button",{className:"dropdown-item",onClick:()=>o(s.id,!1),children:[t.jsx("i",{className:"mdi mdi-restore me-1"}),t.jsx("span",{children:"Habilitar"})]}),t.jsx(j,{content:"Eliminar definitivamente",children:t.jsxs("button",{className:"dropdown-item",onClick:()=>r(s.id),children:[t.jsx("i",{className:"mdi mdi-delete me-1"}),t.jsx("span",{children:"Eliminar"})]})})]})]}),t.jsxs("h4",{className:"header-title mt-0 mb-1 text-truncate",children:[!s.status&&t.jsx("small",{className:"me-1 text-danger fw-bold",children:"(Deshabilitada)"}),s.name]}),t.jsxs("div",{className:"mb-2",children:[t.jsx("span",{className:"d-block",children:(m=s.creator)==null?void 0:m.fullname}),t.jsx("small",{className:"text-muted",children:(w=s.creator)==null?void 0:w.email})]}),(i==null?void 0:i.length)>0&&t.jsx("div",{className:"d-flex gap-2",children:i==null?void 0:i.map(e=>t.jsx(j,{content:`Eliminar ${e.name} de ${s.name}`,children:t.jsxs("div",{className:"hover-container",children:[t.jsx("img",{className:"avatar-xs",src:`//${e.correlative}.${N.APP_DOMAIN}/assets/img/icon.svg`,onError:n=>n.target.src="/assets/img/icon.svg",alt:e.name,style:{objectFit:"contain",objectPosition:"center"}}),t.jsx("button",{className:"hover:show btn btn-light btn-xs rounded-pill",onClick:()=>l(e.match_id),children:t.jsx("i",{className:"mdi mdi-close"})})]},e.id)}))}),t.jsxs("div",{className:"d-flex align-items-center gap-2",children:[t.jsx("hr",{className:"flex-grow-1 my-2"}),t.jsxs("span",{children:[(a==null?void 0:a.length)||0," usuarios"]})]}),t.jsx("div",{className:"table-responsive",style:{height:"241px"},children:t.jsx("table",{className:"table table-sm mb-0",children:t.jsx("tbody",{children:a==null?void 0:a.map((e,n)=>t.jsxs("tr",{children:[t.jsx("td",{valign:"middle",style:{width:"0%",borderBottomWidth:n===a.length-1?0:void 0},children:t.jsxs("div",{className:"position-relative",style:{width:"max-content",height:"max-content"},children:[t.jsx("img",{src:`/api/profile/thumbnail/${e.relative_id}`,alt:"",className:"avatar-sm rounded-circle"}),t.jsx(j,{content:e.service.name,children:t.jsx("img",{className:"position-absolute bg-white rounded border",src:`//${e.service.correlative}.${N.APP_DOMAIN}/assets/img/icon.svg`,onError:u=>u.target.src="/assets/img/icon.svg",alt:e.service.name,style:{objectFit:"contain",objectPosition:"center",width:"20px",height:"20px",padding:"2px",bottom:"-6px",right:"-6px"}})})]})}),t.jsxs("td",{style:{width:"100%",borderBottomWidth:n===a.length-1?0:void 0},children:[t.jsx("span",{className:"d-block",children:e.fullname}),t.jsx("small",{className:"text-muted",children:e.email})]}),t.jsx("td",{valign:"middle",style:{borderBottomWidth:n===a.length-1?0:void 0},children:e.id!=s.creator.id&&t.jsx("button",{className:"btn btn-xs btn-soft-danger",onClick:()=>d(e.match_id),children:t.jsx("i",{className:"fa fa-trash-alt"})})})]},n))})})})]})},s.id)},b=new y,D=({businesses:o})=>{const[r,s]=g.useState(o),a=async(i,c)=>{const d=await b.status({id:i,status:c});s(r.map(l=>l.id===i?d:l))},h=async i=>{!(await x.fire({title:"¿Estás seguro?",text:"¡Esta acción no se puede deshacer!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"¡Sí, continuar!"})).isConfirmed||!(await x.fire({title:"¿Estás REALMENTE seguro?",text:"¡Esta es tu última oportunidad, la acción no se podrá revertir!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"¡Sí, eliminar definitivamente!"})).isConfirmed||!await b.delete(i)||s(r.filter(m=>m.id!==i))};return t.jsx(t.Fragment,{children:t.jsx("div",{className:"d-flex flex-wrap gap-3 justify-content-center",children:r.map(i=>t.jsx(A,{...i,onStatusClicked:a,onDeleteClicked:h}))})})};C((o,r)=>{if(!r.can("businesses","root"))return location.href="/";v(o).render(t.jsx(B,{...r,title:"Empresas",children:t.jsx(D,{...r})}))});
