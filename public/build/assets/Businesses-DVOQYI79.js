var g=Object.defineProperty;var N=(a,s,i)=>s in a?g(a,s,{enumerable:!0,configurable:!0,writable:!0,value:i}):a[s]=i;var h=(a,s,i)=>N(a,typeof s!="symbol"?s+"":s,i);import{j as e}from"./Accordion-B0xeqd_u.js";import{c as w}from"./ReactAppend-Da6mr3zD.js";import{C as v,G as b}from"./CreateReactScript-wxngZ06p.js";import{A as C}from"./Adminto-D364ytFN.js";import{r as p}from"./index-B80Lgev0.js";import{S as j}from"./SurveyStep-C1GxQ1hd.js";import{i as f}from"./tippy-react.esm-PO7soYrD.js";import{B}from"./BusinessIWorkCard-CQ8PkW75.js";import"./index-STwnHZb6.js";import"./index.esm-X2U-7gJn.js";import"./___vite-browser-external_commonjs-proxy-C9-083JZ.js";import"./main-DtAlmsP1.js";import"./Logout-C-aUOij0.js";import"./TippyButton-DN-nzi_f.js";import"./WhatsAppModal-BYoU6ug0.js";class y extends B{constructor(){super(...arguments);h(this,"path","root/businesses")}}const u=new y,E=({businesses:a})=>{p.useRef();const[s,i]=p.useState(a),m=async(t,o)=>{const l=await u.status({id:t,status:o});i(s.map(n=>n.id===t?l:n))},x=async t=>{!(await j.fire({title:"¿Estás seguro?",text:"¡Esta acción no se puede deshacer!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"¡Sí, continuar!"})).isConfirmed||!(await j.fire({title:"¿Estás REALMENTE seguro?",text:"¡Esta es tu última oportunidad, la acción no se podrá revertir!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"¡Sí, eliminar definitivamente!"})).isConfirmed||!await u.delete(t)||i(s.filter(d=>d.id!==t))};return e.jsx(e.Fragment,{children:e.jsx("div",{className:"d-flex flex-wrap gap-3 justify-content-center",children:s.map(t=>{var o,l,n,d;return e.jsx("div",{className:"card mb-0",style:{width:"420px"},children:e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"dropdown float-end",children:[e.jsx("a",{href:"#",className:"dropdown-toggle arrow-none card-drop","data-bs-toggle":"dropdown","aria-expanded":"false",children:e.jsx("i",{className:"mdi mdi-dots-vertical"})}),e.jsxs("div",{className:"dropdown-menu dropdown-menu-end ",children:[t.status?e.jsxs("button",{className:"dropdown-item",onClick:()=>m(t.id,!0),children:[e.jsx("i",{className:"mdi mdi-cancel me-1"}),e.jsx("span",{children:"Deshabilitar"})]}):e.jsxs("button",{className:"dropdown-item",onClick:()=>m(t.id,!1),children:[e.jsx("i",{className:"mdi mdi-restore me-1"}),e.jsx("span",{children:"Habilitar"})]}),e.jsx(f,{content:"Eliminar definitivamente",children:e.jsxs("button",{className:"dropdown-item",onClick:()=>x(t.id),children:[e.jsx("i",{className:"mdi mdi-delete me-1"}),e.jsx("span",{children:"Eliminar"})]})})]})]}),e.jsxs("h4",{className:"header-title mt-0 mb-1 text-truncate",children:[!t.status&&e.jsx("small",{className:"me-1 text-danger fw-bold",children:"(Deshabilitada)"}),t.name]}),e.jsxs("div",{children:[e.jsx("span",{className:"d-block",children:(o=t.creator)==null?void 0:o.fullname}),e.jsx("small",{className:"text-muted",children:(l=t.creator)==null?void 0:l.email})]}),e.jsxs("div",{className:"d-flex align-items-center gap-2",children:[e.jsx("hr",{className:"flex-grow-1 my-2"}),e.jsxs("span",{children:[((n=t.users)==null?void 0:n.length)||0," usuarios"]})]}),e.jsx("div",{className:"table-responsive",style:{height:"241px"},children:e.jsx("table",{className:"table table-sm mb-0",children:e.jsx("tbody",{children:(d=t.users)==null?void 0:d.map((r,c)=>e.jsxs("tr",{children:[e.jsx("td",{valign:"middle",style:{width:"0%",borderBottomWidth:c===t.users.length-1?0:void 0},children:e.jsxs("div",{className:"position-relative",style:{width:"max-content",height:"max-content"},children:[e.jsx("img",{src:`/api/profile/thumbnail/${r.relative_id}`,alt:"",className:"avatar-sm rounded-circle"}),e.jsx(f,{content:r.service.name,children:e.jsx("img",{className:"position-absolute bg-white rounded border",src:`//${r.service.correlative}.${b.APP_DOMAIN}/assets/img/icon.svg`,alt:r.service.name,style:{objectFit:"contain",objectPosition:"center",width:"18px",height:"18px",padding:"2px",bottom:"-4px",right:"-4px"}})})]})}),e.jsxs("td",{style:{width:"100%",borderBottomWidth:c===t.users.length-1?0:void 0},children:[e.jsx("span",{className:"d-block",children:r.fullname}),e.jsx("small",{className:"text-muted",children:r.email})]}),e.jsx("td",{valign:"middle",style:{borderBottomWidth:c===t.users.length-1?0:void 0},children:e.jsx("button",{className:"btn btn-xs btn-soft-danger",onClick:()=>x(r.id),children:e.jsx("i",{className:"fa fa-trash-alt"})})})]},c))})})})]})},t.id)})})})};v((a,s)=>{if(!s.can("businesses","root"))return location.href="/";w(a).render(e.jsx(C,{...s,title:"Empresas",children:e.jsx(E,{...s})}))});
