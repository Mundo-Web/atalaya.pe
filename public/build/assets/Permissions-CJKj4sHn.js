import{j as t}from"./Accordion-B0xeqd_u.js";import{r as o}from"./index-B80Lgev0.js";import{c as R}from"./ReactAppend-Da6mr3zD.js";import{C as b}from"./CreateReactScript-DPV5DI5P.js";import{T as g,R as n}from"./Table-BKtRPVyk.js";import{P as d,T as v}from"./TextareaFormGroup-CTgsu98K.js";import{A as T}from"./Adminto-DfITgRsP.js";import{M as F}from"./Modal-DydUDwtE.js";import{I as y}from"./InputFormGroup-Bup-dfDc.js";import{T as x}from"./TippyButton-Bqhz5Wik.js";import"./index-STwnHZb6.js";import"./index.esm-2kqrH1CN.js";import"./___vite-browser-external_commonjs-proxy-C9-083JZ.js";import"./main-DtAlmsP1.js";import"./Logout-C-aUOij0.js";import"./tippy-react.esm-PO7soYrD.js";import"./TippyButton-DN-nzi_f.js";import"./WhatsAppModal-BYoU6ug0.js";import"./SurveyStep-C1GxQ1hd.js";const w=({can:i})=>{const s=o.useRef(),l=o.useRef(),a=o.useRef(),c=o.useRef(),m=o.useRef(),[p,u]=o.useState(!1),f=e=>{e!=null&&e.id?u(!0):u(!1),a.current.value=(e==null?void 0:e.id)||null,c.current.value=(e==null?void 0:e.name)||null,m.current.value=(e==null?void 0:e.description)||null,$(l.current).modal("show")},h=async e=>{e.preventDefault();const r={id:a.current.value||void 0,name:c.current.value,description:m.current.value};await d.save(r)&&($(s.current).dxDataGrid("instance").refresh(),$(l.current).modal("hide"))},j=async e=>{await d.delete(e)&&$(s.current).dxDataGrid("instance").refresh()};return t.jsxs(t.Fragment,{children:[t.jsx(g,{gridRef:s,title:"Permisos",rest:d,toolBar:e=>{e.unshift({widget:"dxButton",location:"after",options:{icon:"refresh",hint:"Refrescar tabla",onClick:()=>$(s.current).dxDataGrid("instance").refresh()}}),i("permissions","root","all","create")&&e.unshift({widget:"dxButton",location:"after",options:{icon:"plus",hint:"Nuevo registro",onClick:()=>f()}})},columns:[{dataField:"id",caption:"ID",dataType:"number",sortOrder:"asc"},{dataField:"name",caption:"Permiso"},{dataField:"description",caption:"Descripcion"},{dataField:"created_at",caption:"Fecha creacion",dataType:"date",cellTemplate:(e,{data:r})=>{n(e,t.jsx("span",{children:moment(r.created_at).format("LL")}))}},{dataField:"updated_at",caption:"Fecha actualizacion",dataType:"date",cellTemplate:(e,{data:r})=>{n(e,t.jsx("span",{children:moment(r.updated_at).format("LL")}))}},i("permissions","root","all","update","delete")?{caption:"Acciones",cellTemplate:(e,{data:r})=>{e.attr("style","display: flex; gap: 4px; overflow: unset"),i("permissions","root","all","update")&&n(e,t.jsx(x,{className:"btn btn-xs btn-soft-primary",title:"Editar",onClick:()=>f(r),children:t.jsx("i",{className:"fa fa-pen"})})),i("permissions","root","all","delete")&&n(e,t.jsx(x,{className:"btn btn-xs btn-soft-danger",title:"Eliminar",onClick:()=>j(r.id),children:t.jsx("i",{className:"fa fa-trash-alt"})}))},allowFiltering:!1,allowExporting:!1}:null]}),t.jsx(F,{modalRef:l,title:p?"Editar permiso":"Agregar permiso",onSubmit:h,children:t.jsxs("div",{className:"row",children:[t.jsxs("p",{children:["Intenta con el formato ",t.jsx("code",{children:"ventana.permiso"}),". Ej: ",t.jsx("code",{children:"clients.create"}),", ",t.jsx("code",{children:"clients.list"}),", ",t.jsx("code",{children:"clients.update"}),", ",t.jsx("code",{children:"clients.delete"})]}),t.jsx("input",{ref:a,type:"hidden"}),t.jsx(y,{eRef:c,label:"Permiso",col:"col-12",required:!0,disabled:p}),t.jsx(v,{eRef:m,label:"Descripcion",col:"col-12"})]})})]})};b((i,s)=>{if(!s.can("permissions","root","all","list"))return location.href="/";R(i).render(t.jsx(T,{...s,title:"Permisos",children:t.jsx(w,{...s})}))});
